延时：

1. 单机**内存**访问延时在纳秒数量级（通常是10ns左右）
2. 正常一次网络通信的延迟在0.1-1ms左右（相当于内存延时的100倍）



**网络分区：**

指，在分布式系统中，不同的节点分布在不同的子网络中，由于一些特殊的原因导致这些子网络之间出现网络不连通的状况，但各个子网络的内部网络是正常的，从而导致整个系统的网络环境被切分成了若干个孤立的区域。

注：组成一个分布式系统的每个节点的加入与退出都可以看作是一个特殊的网络分区



## CAP定理

 **一致性：**



指，再一个数据分片的多个副本之间数据能够保证一致的特性。

 **可用性：**

指系统提供的服务必须一直处于可用的状态，对于用户的每一个操作请求总是能够**在有限的时间内返回结果**

1. 有限的时间内

   指，对于用户的一个操作请求，系统必须能够在指定的时间（即响应时间）内返回对应的处理结果，如果超过这个时间范围，那么系统就被认为是不可用的。

   有限的时间内：是一个在系统设计之初就设定好的系统运行指标，通常不同的系统之间会有很大的不同。比如，对一个在线搜索引擎来说，通常在0.5s内需要给出用户搜索关键词对应的检索结果。而对于一个面向HIVE的海量数据查询平台来说，正常的一次数据检索时间可能在20-30s之间。而如果是一i个时间跨度较大的数据内容查询，时间可能长达几分钟或更久。

   综上，就是说系统必须存在一个合理的响应时间

2. 返回结果

   要求系统完成处理后，返回一个正常的响应结果，明确地反映出请求的处理结果，即成功或失败。而不是一个可能困惑的异常信息



**分区容错性：**

指，分布式系统在遇到任何网络分区故障的时候，仍然需要能够保证对外提供满足一致性和可用性的服务，除非整个网络环境都发生了故障。



**三态：**成功/失败/超时



Paxos

P1：一个Acceptor必须批准它收到的第一个提案

P2：如果编号为M0、Value值为V0的提案，被 **选定**了，那么所有比编号M0更高的，且被**选定的**提案，其Value值必须也是V0



P2a：如果编号为M0、Value值为V0的提案，被**选定**了，那么所有比编号M0更高的，且被**批准的**提案，其Value值必须也是V0，决策者可以返回V0给提议者。



**P2a包含 P2，但是不能满足P1，要通过P2b加强**



P2b：如果一个提案[M0,V0]被选定后，那么之后任何提议者产生的编号更高的提案，**其值必须为V0**（这个保证不了吧！）



**P2b包含P2和P1**



P2c：对于任意的Mn和Vn，如果提案[Mn,Vn]被提出，那么肯定存在一个由半数以上的Acceptor组成的集合S，满足以下两个条件的任意一个

* S中不存在任何批准过编号小于Mn的提案的决策者（多数派没有批准任意一个提议，**这样肯定没有值被选定**）
* 选取S中所有Acceptor批准的编号小于Mn的提案，其中编号最大的那个提案其Value值是Vn（这样就能保证，**如果之前有值被选定了，那Value肯定是V0**）





